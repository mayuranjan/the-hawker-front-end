{"version":3,"sources":["../../../../../src/app/typescripts/pro/autocomplete/services/remoteDataService.ts"],"names":[],"mappings":"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","file":"remoteDataService.js","sourceRoot":"","sourcesContent":["import { Http, Response, Headers, RequestOptions } from \"@angular/http\";\r\nimport { Subscription } from \"rxjs/Subscription\";\r\nimport \"rxjs/add/operator/map\";\r\nimport \"rxjs/add/operator/catch\";\r\n\r\nimport { CompleterBaseData } from \"./baseDataService\";\r\nimport { CompleterItem } from \"../components/completerItemComponent\";\r\n\r\nexport class RemoteData extends CompleterBaseData {\r\n    private _remoteUrl: string;\r\n    private remoteSearch: Subscription;\r\n    private _urlFormater: (term: string) => string = null;\r\n    private _dataField: string = null;\r\n    private _headers: Headers;\r\n    private _requestOptions: RequestOptions;\r\n\r\n\r\n    constructor(private http: Http) {\r\n        super();\r\n    }\r\n\r\n    public remoteUrl(remoteUrl: string) {\r\n        this._remoteUrl = remoteUrl;\r\n        return this;\r\n    }\r\n\r\n    public urlFormater(urlFormater: (term: string) => string) {\r\n        this._urlFormater = urlFormater;\r\n    }\r\n\r\n    public dataField(dataField: string) {\r\n        this._dataField = dataField;\r\n    }\r\n\r\n    /**\r\n     * @deprecated Please use the requestOptions to pass headers with the search request\r\n     */\r\n    public headers(headers: Headers) {\r\n        this._headers = headers;\r\n    }\r\n\r\n    public requestOptions(requestOptions: RequestOptions) {\r\n        this._requestOptions = requestOptions;\r\n    }\r\n\r\n    public search(term: string): void {\r\n        this.cancel();\r\n        // let params = {};\r\n        let url = \"\";\r\n        if (this._urlFormater) {\r\n            url = this._urlFormater(term);\r\n        } else {\r\n            url = this._remoteUrl + encodeURIComponent(term);\r\n        }\r\n\r\n        /*\r\n         * If requestOptions are provided, they will override anything set in headers.\r\n         *\r\n         * If no requestOptions are provided, a new RequestOptions object will be instantiated,\r\n         * and either the provided headers or a new Headers() object will be sent.\r\n         */\r\n        if (!this._requestOptions) {\r\n            this._requestOptions = new RequestOptions();\r\n            this._requestOptions.headers = this._headers || new Headers();\r\n        }\r\n\r\n        this.remoteSearch = this.http.get(url, this._requestOptions)\r\n            .map((res: Response) => res.json())\r\n            .map((data: any) => {\r\n                let matches = this.extractValue(data, this._dataField);\r\n                return this.extractMatches(matches, term);\r\n            })\r\n            .map(\r\n            (matches: any[]) => {\r\n                let results = this.processResults(matches);\r\n                this.next(results);\r\n                return results;\r\n            })\r\n            .catch((err) => {\r\n                this.error(err);\r\n                return null;\r\n            })\r\n            .subscribe();\r\n    }\r\n\r\n    public cancel() {\r\n        if (this.remoteSearch) {\r\n            this.remoteSearch.unsubscribe();\r\n        }\r\n    }\r\n\r\n    public convertToItem(data: any): CompleterItem {\r\n        return super.convertToItem(data);\r\n    }\r\n}"]}